{"version":3,"sources":["app/shared/config/config-dynatrace/config-dynatrace.component.ts"],"names":["core_1","require","config_service_1","davis_service_1","_","ConfigDynatraceComponent","iDavis","iConfig","this","submitted","submitButton","isDirty","prototype","doSubmit","_this","values","dynatrace","url","slice","substring","length","connectDynatrace","then","result","success","validateDynatrace","res","config","isWizard","SelectView","error","message","err","catch","validate","isEqual","original","keySubmit","keyCode","ngOnInit","document","getElementsByName","focus","__decorate","Component","moduleId","module","id","selector","templateUrl","DavisService","ConfigService","exports"],"mappings":"sgBAAAA,OAAAC,QAAA,iBAGAC,iBAAAD,QAAA,qBACAE,gBAAAF,QAAA,uBACAG,EAAAH,QAAA,UAOaI,yBAAwB,WAMnC,QAAAA,GACSC,EACAC,GADAC,KAAAF,OAAAA,EACAE,KAAAD,QAAAA,EANTC,KAAAC,WAAqB,EACrBD,KAAAE,aAAwBF,KAAKF,OAAe,SAAI,WAAa,OAC7DE,KAAAG,SAAmB,EAuErB,MAjEEN,GAAAO,UAAAC,SAAA,WAAA,GAAAC,GAAAN,IACEA,MAAKE,aAAe,YAC+B,MAA/CF,KAAKF,OAAOS,OAAOC,UAAUC,IAAIC,OAAM,KACzCV,KAAKF,OAAOS,OAAOC,UAAUC,IAAMT,KAAKF,OAAOS,OAAOC,UAAUC,IAAIE,UAAU,EAAGX,KAAKF,OAAOS,OAAOC,UAAUC,IAAIG,OAAS,IAE7HZ,KAAKF,OAAOe,mBACPC,KAAK,SAAAC,GACAA,EAAOC,QACTV,EAAKR,OAAOmB,oBACXH,KAAK,SAAAI,GACAA,EAAIF,SACNV,EAAKR,OAAOqB,OAAkB,UAAEH,SAAU,EACtCV,EAAKR,OAAOsB,SACdd,EAAKP,QAAQsB,WAAW,QAExBf,EAAKJ,aAAe,SAGtBI,EAAKR,OAAOqB,OAAkB,UAAEH,SAAU,EAC1CV,EAAKR,OAAOqB,OAAkB,UAAEG,MAAQJ,EAAIK,QAC5CjB,EAAKJ,aAAgBI,EAAKR,OAAe,SAAI,WAAa,SAG9D,SAAA0B,GACElB,EAAKR,OAAOqB,OAAkB,UAAEH,SAAU,EAC1CV,EAAKR,OAAOqB,OAAkB,UAAEG,MAAQ,6CACxChB,EAAKJ,aAAgBI,EAAKR,OAAe,SAAI,WAAa,SAE3D2B,MAAM,SAAAD,GACLlB,EAAKR,OAAOqB,OAAkB,UAAEH,SAAU,EAC1CV,EAAKR,OAAOqB,OAAkB,UAAEG,MAAQ,6CACxChB,EAAKJ,aAAgBI,EAAKR,OAAe,SAAI,WAAa,UAG5DQ,EAAKR,OAAOqB,OAAkB,UAAEH,SAAU,EAC1CV,EAAKR,OAAOqB,OAAkB,UAAEG,MAAQP,EAAOQ,QAC/CjB,EAAKJ,aAAgBI,EAAKR,OAAe,SAAI,WAAa,SAG9D,SAAAwB,GACEhB,EAAKR,OAAOqB,OAAkB,UAAEH,SAAU,EAC1CV,EAAKR,OAAOqB,OAAkB,UAAEG,MAAQ,6CACxChB,EAAKJ,aAAgBI,EAAKR,OAAe,SAAI,WAAa,SAE3D2B,MAAM,SAAAD,GACLlB,EAAKR,OAAOqB,OAAkB,UAAEH,SAAU,EAC1CV,EAAKR,OAAOqB,OAAkB,UAAEG,MAAQ,6CACxChB,EAAKJ,aAAgBI,EAAKR,OAAe,SAAI,WAAa,SAEhEE,KAAKC,WAAY,GAGnBJ,EAAAO,UAAAsB,SAAA,WACE1B,KAAKG,SAAWP,EAAE+B,QAAQ3B,KAAKF,OAAOS,OAAOC,UAAWR,KAAKF,OAAOS,OAAOqB,SAASpB,YAGtFX,EAAAO,UAAAyB,UAAA,SAAUC,GACQ,KAAZA,GACF9B,KAAKK,YAITR,EAAAO,UAAA2B,SAAA,WACEC,SAASC,kBAAkB,OAAO,GAAGC,SAEzCrC,IA3EaA,0BAAwBsC,YALpC3C,OAAA4C,WACCC,SAAUC,OAAOC,GACjBC,SAAU,mBACVC,YAAa,sEASI9C,gBAAA+C,aACChD,iBAAAiD,iBARP9C,0BAAA+C,QAAA/C,yBAAAA","file":"../../../../../app/shared/config/config-dynatrace/config-dynatrace.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\n\n// Services\nimport { ConfigService } from '../config.service';\nimport { DavisService } from '../../davis.service';\nimport * as _ from \"lodash\";\n\n@Component({\n  moduleId: module.id,\n  selector: 'config-dynatrace',\n  templateUrl: './config-dynatrace.component.html',\n})\nexport class ConfigDynatraceComponent implements OnInit {\n\n  submitted: boolean = false;\n  submitButton: string = (this.iDavis.isWizard) ? 'Continue' : 'Save';\n  isDirty: boolean = false;\n    \n  constructor(\n    public iDavis: DavisService,\n    public iConfig: ConfigService) { }\n  \n  doSubmit() {\n    this.submitButton = 'Saving...';\n    if (this.iDavis.values.dynatrace.url.slice(-1) === '/') {\n      this.iDavis.values.dynatrace.url = this.iDavis.values.dynatrace.url.substring(0, this.iDavis.values.dynatrace.url.length - 1);\n    }\n    this.iDavis.connectDynatrace()\n        .then(result => {\n          if (result.success) {\n            this.iDavis.validateDynatrace()\n            .then(res => {\n              if (res.success) {\n                this.iDavis.config['dynatrace'].success = true;\n                if (this.iDavis.isWizard) {\n                  this.iConfig.SelectView('user');\n                } else {\n                  this.submitButton = 'Save';\n                }\n              } else {\n                this.iDavis.config['dynatrace'].success = false;\n                this.iDavis.config['dynatrace'].error = res.message;\n                this.submitButton = (this.iDavis.isWizard) ? 'Continue' : 'Save';\n              }\n            },\n            err => {\n              this.iDavis.config['dynatrace'].success = false;\n              this.iDavis.config['dynatrace'].error = 'Sorry an error occurred, please try again.';\n              this.submitButton = (this.iDavis.isWizard) ? 'Continue' : 'Save';\n            })\n            .catch(err => {\n              this.iDavis.config['dynatrace'].success = false;\n              this.iDavis.config['dynatrace'].error = 'Sorry an error occurred, please try again.';\n              this.submitButton = (this.iDavis.isWizard) ? 'Continue' : 'Save';\n            });\n          } else {\n            this.iDavis.config['dynatrace'].success = false;\n            this.iDavis.config['dynatrace'].error = result.message;\n            this.submitButton = (this.iDavis.isWizard) ? 'Continue' : 'Save';\n          }\n        },\n        error => {\n          this.iDavis.config['dynatrace'].success = false;\n          this.iDavis.config['dynatrace'].error = 'Sorry an error occurred, please try again.';\n          this.submitButton = (this.iDavis.isWizard) ? 'Continue' : 'Save';\n        })\n        .catch(err => {\n          this.iDavis.config['dynatrace'].success = false;\n          this.iDavis.config['dynatrace'].error = 'Sorry an error occurred, please try again.';\n          this.submitButton = (this.iDavis.isWizard) ? 'Continue' : 'Save';\n        });\n    this.submitted = true;\n  }\n  \n  validate() {\n    this.isDirty = !_.isEqual(this.iDavis.values.dynatrace, this.iDavis.values.original.dynatrace);\n  }\n  \n  keySubmit(keyCode: any) {\n    if (keyCode === 13) {\n      this.doSubmit();\n    }\n  }\n  \n  ngOnInit() {\n    document.getElementsByName('url')[0].focus();\n  }\n}\n"]}