"use strict";var __decorate=this&&this.__decorate||function(e,t,i,r){var a,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(s<3?a(n):s>3?a(t,i,n):a(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),router_1=require("@angular/router"),davis_service_1=require("../../shared/davis.service"),WizardGuard=function(){function e(e,t){this.iDavis=e,this.router=t}return e.prototype.canActivate=function(e,t){return!(!this.iDavis.isWizard&&!this.iDavis.token)||this.CheckUser()},e.prototype.CheckUser=function(){var e=this;return this.iDavis.values.authenticate.email="admin@localhost",this.iDavis.values.authenticate.password="changeme",this.iDavis.getJwtToken().then(function(t){return e.CheckUserResponse(t)},function(t){return e.CheckUserError(t)})},e.prototype.CheckUserResponse=function(e){return e.success?(this.iDavis.isWizard=!0,this.iDavis.token=e.token,this.iDavis.values.user.admin=!0,!0):sessionStorage.getItem("token")?(this.iDavis.isWizard=!1,this.iDavis.token=sessionStorage.getItem("token"),this.iDavis.isAuthenticated=!0,this.iDavis.isAdmin="true"===sessionStorage.getItem("isAdmin"),this.iDavis.values.authenticate.email=sessionStorage.getItem("email"),this.router.navigate(["/configuration"]),!0):(this.iDavis.isWizard=!1,this.router.navigate(["/auth/login"]),!1)},e.prototype.CheckUserError=function(e){return this.iDavis.isWizard=!1,this.router.navigate(["/auth/login"]),!1},e}();WizardGuard=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[davis_service_1.DavisService,router_1.Router])],WizardGuard),exports.WizardGuard=WizardGuard;
//# sourceMappingURL=../../../maps/app/auth/auth-guard/wizard-guard.service.js.map
