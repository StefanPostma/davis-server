"use strict";var __decorate=this&&this.__decorate||function(e,t,i,s){var r,a=arguments.length,o=a<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var n=e.length-1;n>=0;n--)(r=e[n])&&(o=(a<3?r(o):a>3?r(t,i,o):r(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),router_1=require("@angular/router"),davis_service_1=require("../../shared/davis.service"),ConfigGuard=function(){function e(e,t){this.iDavis=e,this.router=t}return e.prototype.canActivate=function(e,t){return!(!this.iDavis.isWizard&&!this.iDavis.token)||this.CheckUser()},e.prototype.CheckUser=function(){var e=this;return this.iDavis.values.authenticate.email="admin@localhost",this.iDavis.values.authenticate.password="changeme",this.iDavis.getJwtToken().then(function(t){return e.CheckUserResponse(t)},function(t){return e.CheckUserError(t)})},e.prototype.CheckUserResponse=function(e){return e.success?(this.iDavis.isWizard=!0,this.iDavis.token=e.token,this.iDavis.values.user.admin=!0,this.router.navigate(["/wizard"]),!1):sessionStorage.getItem("token")&&sessionStorage.getItem("isAdmin")&&sessionStorage.getItem("email")?(this.iDavis.isWizard=!1,this.iDavis.token=sessionStorage.getItem("token"),this.iDavis.isAuthenticated=!0,this.iDavis.isAdmin="true"===sessionStorage.getItem("isAdmin"),this.iDavis.values.authenticate.email=sessionStorage.getItem("email"),!0):(this.iDavis.isWizard=!1,this.router.navigate(["/auth/login"]),!1)},e.prototype.CheckUserError=function(e){return this.iDavis.isWizard=!1,this.router.navigate(["/auth/login"]),!1},e}();ConfigGuard=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[davis_service_1.DavisService,router_1.Router])],ConfigGuard),exports.ConfigGuard=ConfigGuard;
//# sourceMappingURL=../../../maps/app/auth/auth-guard/config-guard.service.js.map
