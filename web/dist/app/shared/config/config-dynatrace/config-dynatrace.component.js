"use strict";var __decorate=this&&this.__decorate||function(i,e,t,a){var n,r=arguments.length,s=r<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,t):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(i,e,t,a);else for(var c=i.length-1;c>=0;c--)(n=i[c])&&(s=(r<3?n(s):r>3?n(e,t,s):n(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},__metadata=this&&this.__metadata||function(i,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(i,e)},core_1=require("@angular/core"),config_service_1=require("../config.service"),davis_service_1=require("../../davis.service"),_=require("lodash"),ConfigDynatraceComponent=function(){function i(i,e){this.iDavis=i,this.iConfig=e,this.submitted=!1,this.submitButton=this.iDavis.isWizard?"Continue":"Save",this.isDirty=!1}return i.prototype.doSubmit=function(){var i=this;this.submitButton="Saving...","/"===this.iDavis.values.dynatrace.url.slice(-1)&&(this.iDavis.values.dynatrace.url=this.iDavis.values.dynatrace.url.substring(0,this.iDavis.values.dynatrace.url.length-1)),this.iDavis.connectDynatrace().then(function(e){e.success?i.iDavis.validateDynatrace().then(function(e){e.success?(i.iDavis.config.dynatrace.success=!0,i.iDavis.isWizard?i.iConfig.SelectView("alexa"):i.submitButton="Save"):(i.iDavis.config.dynatrace.success=!1,i.iDavis.config.dynatrace.error=e.message,i.submitButton=i.iDavis.isWizard?"Continue":"Save")},function(e){i.iDavis.config.dynatrace.success=!1,i.iDavis.config.dynatrace.error="Sorry an error occurred, please try again.",i.submitButton=i.iDavis.isWizard?"Continue":"Save"}).catch(function(e){i.iDavis.config.dynatrace.success=!1,i.iDavis.config.dynatrace.error="Sorry an error occurred, please try again.",i.submitButton=i.iDavis.isWizard?"Continue":"Save"}):(i.iDavis.config.dynatrace.success=!1,i.iDavis.config.dynatrace.error=e.message,i.submitButton=i.iDavis.isWizard?"Continue":"Save")},function(e){i.iDavis.config.dynatrace.success=!1,i.iDavis.config.dynatrace.error="Sorry an error occurred, please try again.",i.submitButton=i.iDavis.isWizard?"Continue":"Save"}).catch(function(e){i.iDavis.config.dynatrace.success=!1,i.iDavis.config.dynatrace.error="Sorry an error occurred, please try again.",i.submitButton=i.iDavis.isWizard?"Continue":"Save"}),this.submitted=!0},i.prototype.validate=function(){this.isDirty=!_.isEqual(this.iDavis.values.dynatrace,this.iDavis.values.original.dynatrace)},i.prototype.keySubmit=function(i){13===i&&this.doSubmit()},i.prototype.ngOnInit=function(){document.getElementsByName("url")[0].focus()},i}();ConfigDynatraceComponent=__decorate([core_1.Component({moduleId:module.id,selector:"config-dynatrace",templateUrl:"./config-dynatrace.component.html"}),__metadata("design:paramtypes",[davis_service_1.DavisService,config_service_1.ConfigService])],ConfigDynatraceComponent),exports.ConfigDynatraceComponent=ConfigDynatraceComponent;
//# sourceMappingURL=../../../../maps/app/shared/config/config-dynatrace/config-dynatrace.component.js.map
